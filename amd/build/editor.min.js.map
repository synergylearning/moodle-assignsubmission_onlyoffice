{"version":3,"sources":["../src/editor.js"],"names":["define","$","str","$onlyOfficeEditor","CONFIG","displayError","error","errorIsAvailable","get_string","when","done","localizedStr","text","addClass","loadOpenOffice","DocsAPI","DocEditor","init","$configEl","config","val","JSON","parse","window","setInterval","clearInterval"],"mappings":"AAAAA,OAAM,sCAAC,CAAC,QAAD,CAAW,UAAX,CAAD,CAAyB,SAAUC,CAAV,CAAaC,CAAb,CAAkB,IAEvCC,CAAAA,CAAiB,CAAGF,CAAC,CAAC,oBAAD,CAFkB,CAKzCG,CAAM,CAAG,EALgC,CAWvCC,CAAY,CAAG,SAASC,CAAT,CAAgB,CACjC,GAAMC,CAAAA,CAAgB,CAAGL,CAAG,CAACM,UAAJ,CAAeF,CAAf,CAAsB,YAAtB,CAAzB,CAEAL,CAAC,CAACQ,IAAF,CAAOF,CAAP,EAAyBG,IAAzB,CAA8B,SAASC,CAAT,CAAuB,CACjDR,CAAiB,CAACS,IAAlB,CAAyBD,CAAzB,CACAR,CAAiB,CAACS,IAAlB,CAAuBD,CAAvB,EAAqCE,QAArC,CAA8C,OAA9C,CACH,CAHD,CAIH,CAlB4C,CAuBvCC,CAAc,CAAG,UAAW,CAE9B,GAAuB,WAAnB,QAAOC,CAAAA,OAAX,CAAoC,CAChCV,CAAY,CAAC,sBAAD,CAAZ,CACA,MACH,CAGD,GAAIU,CAAAA,OAAO,CAACC,SAAZ,CAAsB,8BAAtB,CAAsDZ,CAAtD,CACH,CAhC4C,CAkC7C,MAAO,CACHa,IAAI,CAAE,eAAY,IACVC,CAAAA,CAAS,CAAGjB,CAAC,CAAC,wBAAD,CADH,CAEVkB,CAAM,CAAGD,CAAS,CAACE,GAAV,EAFC,CAGdhB,CAAM,CAAGiB,IAAI,CAACC,KAAL,CAAWH,CAAX,CAAT,CAGAI,MAAM,CAACC,WAAP,CAAmB,UAAW,CAC1B,GAAuB,WAAnB,QAAOT,CAAAA,OAAX,CAAoC,CAChCD,CAAc,GACdW,aAAa,EAChB,CACJ,CALD,CAKG,GALH,CAMH,CAbE,CAeV,CAjDK,CAAN","sourcesContent":["define(['jquery', 'core/str'], function ($, str) {\n    /** OnlyOffice editor element */\n    const $onlyOfficeEditor = $('#onlyoffice-editor');\n\n    /** The config we're sending to OnlyOffice */\n    let CONFIG = '';\n\n    /**\n     * Display an error message\n     * @param error\n     */\n    const displayError = function(error) {\n        const errorIsAvailable = str.get_string(error, 'onlyoffice');\n\n        $.when(errorIsAvailable).done(function(localizedStr) {\n            $onlyOfficeEditor.text = localizedStr;\n            $onlyOfficeEditor.text(localizedStr).addClass(\"error\");\n        });\n    };\n\n    /**\n     * What to do when OnlyOffice has loaded.\n     */\n    const loadOpenOffice = function() {\n        // DocsAPI must be defined at this point.\n        if (typeof DocsAPI === \"undefined\") {\n            displayError('docserverunreachable');\n            return;\n        }\n\n        // Create our OnlyOffice editor.\n        new DocsAPI.DocEditor(\"onlyoffice-editor-submission\", CONFIG);\n    };\n\n    return {\n        init: function () {\n            var $configEl = $('input[name=\"config\"]');\n            let config = $configEl.val();\n            CONFIG = JSON.parse(config);\n\n            // Keep trying to use DocsAPI (might not be loaded).\n            window.setInterval(function() {\n                if (typeof DocsAPI !== \"undefined\") {\n                    loadOpenOffice();\n                    clearInterval();\n                }\n            }, 5000);\n        }\n    };\n});"],"file":"editor.min.js"}